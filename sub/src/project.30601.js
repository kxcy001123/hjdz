require=function r(s,l,c){function h(t,e){if(!l[t]){if(!s[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(a)return a(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var o=l[t]={exports:{}};s[t][0].call(o.exports,function(e){return h(s[t][1][e]||e)},o,o.exports,r,s,l,c)}return l[t].exports}for(var a="function"==typeof require&&require,e=0;e<c.length;e++)h(c[e]);return h}({app:[function(e,t,i){"use strict";cc._RF.push(t,"bc1232H3k9KVrNRZCI16+a3","app");var n=e("cmd");window.wx&&(n.init(),wx.onMessage(function(e){"setUserScore"===e.event&&n.setUserScore(e.data),cc.systemEvent.emit("wxEvent",e)})),cc._RF.pop()},{cmd:"cmd"}],base64:[function(e,t,o){(function(e){"use strict";cc._RF.push(t,"291bad/bldIKJk4D47lYiE8","base64");var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(e){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var t={encode:function(e){for(var t,i,n=String(e),o=a,r=0,s="",l=.75;!isNaN(t=n.charCodeAt(l))||63&r||(o="=",(l-.75)%1);l+=.75)if(127<t){(i=encodeURI(n.charAt(l)).split("%")).shift();for(var c,h=l%1;c=i[0|h];h+=.75)r=r<<8|parseInt(c,16),s+=o.charAt(63&r>>8-h%1*8);l=.75===l?0:l,l+=.75*i.length%1}else r=r<<8|t,s+=o.charAt(63&r>>8-l%1*8);return s},decode:function(e){var t,i=String(e),n=a.slice(0,-1),o=[6,4,2,0],r="",s=0,l=0,c="";try{for(var h=0;-1<(t=n.indexOf(i[h]));h++)s=s<<6|t,h%4&&((l=255&s>>o[h%4])<128?(r+=c?decodeURI(c):"",r+=String.fromCharCode(l),c=""):c+="%"+("0"+l.toString(16)).slice(-2));return r+=c?decodeURI(c):""}catch(e){throw new Error("base64 malformed!")}}};if("function"==typeof define&&define.amd)define(function(){return t});else if("object"===(void 0===o?"undefined":n(o)))for(var i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);else e.base64=t})("object"===(void 0===e?"undefined":n(e))&&e||void 0),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],chalkProto:[function(e,t,i){"use strict";cc._RF.push(t,"518a5c6z5hNuoOLOM7srcvo","chalkProto"),t.exports={options:{java_package:"chalk.proto",java_outer_classname:"Chalk",java_multiple_files:!0,optimize_for:"SPEED"},nested:{Bool:{values:{UNDEFINED:0,TRUE:1,FALSE:2}},Event:{values:{NONE:0,MATCH:1,CANCELMATCH:2,START:3,OVER:4,FRAME:5,MOVE:6,BOOST:7,FIRE:8,RESPAWN:9,IDLE:10,RESUME:11,MATCH_OVER:12,MATCH_JOIN:13,STICKER:14,CREATE_ROOM:15,ROOM:16,ROOM_RESULT:17,ENTER_ROOM:18,QUIT_ROOM:19,INVITE_ROOM:20,INVITATION_RESULT:21,REPLAY:22,KICK_ROOM:23,SWITCH_VISIBILITY:24,ROOM_TIMEOUT:25,SYNC:31,PLAY:32,REPORT:64}},Commands:{fields:{commands:{rule:"repeated",type:"Command",id:1}}},Command:{oneofs:{data:{oneof:["start","frame","move","is","scores","resume","over","join","sticker","room","enter","quit","invitation","invitationResult","result","info","replay","roomVisibility","kick","report"]}},fields:{event:{type:"Event",id:1},start:{type:"Start",id:2},frame:{type:"ServerFrame",id:3},move:{type:"Move",id:4},is:{type:"Bool",id:5},scores:{type:"MultiScore",id:7},resume:{type:"Resume",id:9},over:{type:"MatchOver",id:10},join:{type:"MatchJoin",id:11},sticker:{type:"Sticker",id:12},room:{type:"Room",id:13},enter:{type:"Room.Enter",id:14},quit:{type:"Room.Quit",id:15},invitation:{type:"Room.Invitation",id:16},invitationResult:{type:"Room.InvitationResult",id:17},result:{type:"Room.Result",id:18},info:{type:"Info",id:19},replay:{type:"Room.Replay",id:20},roomVisibility:{type:"Room.Visibility",id:21},kick:{type:"Room.Kick",id:22},report:{type:"Report",id:32}}},Resume:{fields:{joiningAgents:{rule:"repeated",type:"string",id:1}}},MatchOver:{fields:{initialAgents:{rule:"repeated",type:"string",id:1},isDedicated:{type:"bool",id:2},version:{type:"string",id:3}}},MatchJoin:{fields:{joiningAgents:{rule:"repeated",type:"string",id:1},roomId:{type:"string",id:2},version:{type:"string",id:3},isEnterImmediately:{type:"bool",id:4},isBot:{type:"bool",id:5}}},MultiScore:{fields:{soilIds:{rule:"repeated",type:"uint32",id:1}}},ServerFrame:{fields:{id:{type:"uint64",id:1},players:{keyType:"int32",type:"Frame",id:2}}},Frame:{fields:{move:{type:"Move",id:1},join:{type:"Join",id:2},boost:{type:"Bool",id:3},fire:{type:"Bool",id:4},idle:{type:"Bool",id:5},respawn:{type:"Respawn",id:7},sticker:{type:"Sticker",id:8}}},Start:{fields:{roomId:{type:"string",id:1},index:{type:"uint32",id:2},seed:{type:"uint32",id:3},frames:{rule:"repeated",type:"ServerFrame",id:4},isDedicated:{type:"bool",id:5}}},Move:{fields:{r:{type:"float",id:1}}},Join:{fields:{openUserId:{type:"string",id:1},name:{type:"string",id:2},skinId:{type:"uint64",id:3},avatarUrl:{type:"string",id:4},country:{type:"string",id:5}}},Respawn:{fields:{uniqueId:{type:"int32",id:1}}},Info:{fields:{name:{type:"string",id:1},skinId:{type:"uint32",id:2},avatarUrl:{type:"string",id:3},bodyUrl:{type:"string",id:4},weaponUrl:{type:"string",id:5},level:{type:"uint32",id:6},country:{type:"string",id:7},version:{type:"string",id:8}}},Sticker:{fields:{stickerId:{type:"uint32",id:1},senderUserId:{type:"string",id:2},scope:{type:"Scope",id:3}},nested:{Scope:{values:{GLOBAL:0,SCREEN:1}}}},Room:{fields:{roomId:{type:"string",id:1},owner:{type:"string",id:2},joiners:{keyType:"string",type:"Info",id:3},index:{type:"uint32",id:4},visibility:{type:"Visibility",id:5},countdownSeconds:{type:"uint32",id:6}},nested:{Visibility:{values:{PRIVATE:0,PUBLIC:1}},Enter:{fields:{openUserId:{type:"string",id:1},info:{type:"Info",id:2}}},Quit:{fields:{openUserId:{type:"string",id:1},owner:{type:"string",id:2}}},Kick:{fields:{kickerUserId:{type:"string",id:1},kickedUserId:{type:"string",id:2}}},Result:{values:{ALREADY_PLAYING:0,ROOM_EXPIRED_OR_NOT_EXISTS:1}},Invitation:{fields:{openUserId:{type:"string",id:1},roomId:{type:"string",id:2},inviterInfo:{type:"Info",id:3}}},InvitationResult:{fields:{openUserId:{type:"string",id:1}}},Replay:{fields:{roomId:{type:"string",id:1},players:{rule:"repeated",type:"string",id:2}}}}},Report:{fields:{id:{type:"string",id:1},index:{type:"uint32",id:2},seed:{type:"uint32",id:3},result:{type:"string",id:4}}}}},cc._RF.pop()},{}],cmd:[function(e,t,i){"use strict";cc._RF.push(t,"6d007Axwx9FPJZoMClIKVHS","cmd");var n=e("tool"),a=function(){var e=new Date;return e.getFullYear()+""+n.weekOfYear(e)},s={},l={userInfo:{userId:"",nickName:"",avatar:"",session:""},history:null,week:null},h={history:{data:null,updateTime:0},week:{data:null,updateTime:0}},u={history:{data:null,updateTime:0},week:{data:null,updateTime:0},shareTicket:""};s.init=function(){s.getUserInfo(),s._getUserWeekScore(),s._getUserHistoryScore()},s._getUserInfoCbs=[],s._getUserInfoIng=!1,s.getUserInfo=function(e){e&&s._getUserInfoCbs.push(e),s._getUserInfoIng||(s._getUserInfoIng=!0,s._getUserInfo(function(t,e){s._getUserInfoIng=!1;var i=Object.assign(Object.create(null),e);s._getUserInfoCbs.forEach(function(e){e(t,i)}),s._getUserInfoCbs.length=0}))},s._getUserInfo=function(o){if(l.userInfo.userId)o&&o(null,l.userInfo);else{var r=n.randomString(32,2);console.log("session",r),wx.setUserCloudStorage({KVDataList:[{key:"session",value:r}],success:function(){(wx.getFriendCloudStorage||wx.getCloudStorageByRelation)({keyList:["session"],success:function(e){var t,i=0;for(t=e.data.length;i<t;i++){var n=e.data[i];if((n.KVDataList&&n.KVDataList.length&&n.KVDataList[0].value)===r){if(l.userInfo.userId){l.userInfo.avatar="",l.userInfo.nickName="",l.userInfo.userId="",l.userInfo.session="";break}l.userInfo.avatar=n.avatarUrl,l.userInfo.nickName=n.nickname,l.userInfo.userId=n.openid,l.userInfo.session=r}}i===t?o&&o(null,l.userInfo):(console.log("getSession fail",e),s._getUserInfo())},fail:function(e){console.log("getSession fail"),s._getUserInfo()}})},fail:function(e){console.log("setSession fail"),s._getUserInfo()}})}},s._getUserHistoryScore=function(i){l.history?i&&i(null,l.history.value):wx.getUserCloudStorage({keyList:["history"],success:function(e){var t=e.KVDataList[0];(t=t||{key:"history",value:"0"}).value=parseInt(t.value),l.history=t,i&&i(null,l.history.value)},fail:function(e){i&&i(e||"error")},complete:function(){}})},s._setUserHistoryScore=function(e,t){"number"==typeof parseInt(e)&&(l.history.value=parseInt(e),wx.setUserCloudStorage({KVDataList:[{key:"history",value:e.toString()}],success:function(){h.history.updateTime=0,t&&t(null)},fail:function(e){t&&t(e||"error")},complete:function(){}}))},s._getUserWeekScore=function(n){l.week?n&&n(null,l.week.value):wx.getUserCloudStorage({keyList:["week"],success:function(e){var t=a();console.log("getUserCloudStorage","week",e,t);var i=e.KVDataList[0];(i=i||{key:"week",value:'{"score":0,"updateTime":0}'}).value=JSON.parse(i.value),i.value.updateTime!==t&&(i.value.score=0,i.value.updateTime=t),l.week=i,n&&n(null,l.week.value)},fail:function(e){n&&n(e||"error")},complete:function(){}})},s._setUserWeekScore=function(e,t,i){"number"==typeof parseInt(e)&&"number"==typeof parseInt(t)&&(l.week.value.score=e,l.week.value.updateTime=t,wx.setUserCloudStorage({KVDataList:[{key:"week",value:JSON.stringify({score:e,updateTime:t})}],success:function(){h.week.updateTime=0,u.week.updateTime=0,i&&i(null)},fail:function(e){i&&i(e||"error")},complete:function(){}}))},s.setUserScore=function(n){if(n){var o=a();console.log("setUserScore",n,o);(function i(){s._getUserHistoryScore(function(e,t){cc.log("getUserCloudStorage","history",e,t),e?setTimeout(i,100):t<=n&&s._setUserHistoryScore(n,function(e){console.log("setUserCloudStorage","history",n,e),e&&setTimeout(i,100)})})})();(function i(){s._getUserWeekScore(function(e,t){cc.log("getUserCloudStorage","week",e,t),e?setTimeout(i,100):(n>=t.score||o!==t.updateTime)&&s._setUserWeekScore(n,o,function(e){console.log("setUserCloudStorage","week",n,o,e),e&&setTimeout(i,100)})})})()}},s._getFriendHistoryScore=function(s){h.history.data&&Date.now()-h.history.updateTime<=18e4?s&&s(null,h.history.data):(wx.getFriendCloudStorage||wx.getCloudStorageByRelation)({keyList:["history"],success:function(e){console.log("wx.getFriendCloudStorage","history",e);for(var t=[],i=0,n=e.data.length;i<n;i++){var o=e.data[i],r=o.KVDataList&&o.KVDataList.length&&o.KVDataList[0].value;r=r||0,r=parseInt(r),t.push({avatarUrl:o.avatarUrl,nickname:o.nickname,openid:o.openid,score:r||0})}h.history.data=t,h.history.updateTime=Date.now(),s&&s(null,t)},fail:function(e){s&&s(e||"error")},complete:function(){}})},s._getFriendHistoryScoreCbs=[],s._getFriendHistoryScoreIng=!1,s.getFriendHistoryScore=function(e){e&&s._getFriendHistoryScoreCbs.push(e),!1===s._getFriendHistoryScoreIng&&(s._getFriendHistoryScoreIng=!0,s._getFriendHistoryScore(function(i,n){cc.log("getFriendCloudStorage","history",i,n),s._getFriendHistoryScoreIng=!1,n=n?JSON.parse(JSON.stringify(n)):[];var e=function(){var t=n.findIndex(function(e){return e.openid==l.userInfo.userId});-1==t?(t=n.length,n.push({avatarUrl:l.userInfo.avatar,nickname:l.userInfo.nickName,openid:l.userInfo.userId,score:l.history?l.history.value:0,self:!0})):l.history&&(n[t].score=l.history.value,n[t].self=!0),s._getFriendHistoryScoreCbs.forEach(function(e){e(i,n,t)}),s._getFriendHistoryScoreCbs.length=0};l.userInfo.userId?e():s.getUserInfo(e)}))},s._getFriendWeekScore=function(c){h.week.data&&Date.now()-h.week.updateTime<=18e4?c&&c(null,h.week.data):(wx.getFriendCloudStorage||wx.getCloudStorageByRelation)({keyList:["week"],success:function(e){console.log("wx.getFriendCloudStorage","week",e);for(var t=[],i=a(),n=0,o=e.data.length;n<o;n++){var r=e.data[n],s=r.KVDataList&&r.KVDataList.length&&r.KVDataList[0].value,l=s?JSON.parse(s):{score:0,updateTime:0};l.updateTime===i&&t.push({avatarUrl:r.avatarUrl,nickname:r.nickname,openid:r.openid,score:l.score})}h.week.data=t,h.week.updateTime=Date.now(),c&&c(null,t)},fail:function(e){c&&c(e||"error")},complete:function(){}})},s._getFriendWeekScoreCbs=[],s._getFriendWeekScoreIng=!1,s.getFriendWeekScore=function(e){e&&s._getFriendWeekScoreCbs.push(e),!1===s._getFriendWeekScoreIng&&(s._getFriendWeekScoreIng=!0,s._getFriendWeekScore(function(i,n){cc.log("getFriendCloudStorage","week",i,n),s._getFriendWeekScoreIng=!1,n=n?JSON.parse(JSON.stringify(n)):[];var e=function(){var t=n.findIndex(function(e){return e.openid==l.userInfo.userId});-1==t?(t=n.length,n.push({avatarUrl:l.userInfo.avatar,nickname:l.userInfo.nickName,openid:l.userInfo.userId,score:l.week?l.week.value.score:0,self:!0})):l.week&&(n[t].score=l.week.value.score,n[t].self=!0),s._getFriendWeekScoreCbs.forEach(function(e){e(i,n,t)}),s._getFriendWeekScoreCbs.length=0};l.userInfo.userId?e():s.getUserInfo(e)}))},s._getGroupWeekScore=function(c,h){u.shareTicket===c&&u.week.data&&Date.now()-u.week.updateTime<=18e4?h&&h(null,u.week.data):wx.getGroupCloudStorage({shareTicket:c,keyList:["week"],success:function(e){console.log("wx.getGroupCloudStorage","week",c,e);for(var t=[],i=a(),n=0,o=e.data.length;n<o;n++){var r=e.data[n],s=r.KVDataList&&r.KVDataList.length&&r.KVDataList[0].value,l=s?JSON.parse(s):{score:0,updateTime:0};l.updateTime===i&&t.push({avatarUrl:r.avatarUrl,nickname:r.nickname,openid:r.openid,score:l.score})}u.week.data=t,u.week.updateTime=Date.now(),u.shareTicket=c,h&&h(null,t)},fail:function(e){h&&h(e||"error")},complete:function(){}})},s._getGroupWeekScoreCbs=[],s._getGroupWeekScoreIng=!1,s.getGroupWeekScore=function(e,t){wx.getGroupCloudStorage?(t&&s._getGroupWeekScoreCbs.push(t),!1===s._getGroupWeekScoreIng&&(s._getGroupWeekScoreIng=!0,s._getGroupWeekScore(e,function(i,n){cc.log("getGroupWeekScore","week",i,n),s._getGroupWeekScoreIng=!1,n=n?JSON.parse(JSON.stringify(n)):[];var e=function(){var t=n.findIndex(function(e){return e.openid==l.userInfo.userId});-1==t?(t=n.length,n.push({avatarUrl:l.userInfo.avatar,nickname:l.userInfo.nickName,openid:l.userInfo.userId,score:l.week?l.week.value.score:0,self:!0})):l.week&&(n[t].score=l.week.value.score,n[t].self=!0),s._getGroupWeekScoreCbs.forEach(function(e){e(i,n,t)}),s._getGroupWeekScoreCbs.length=0};l.userInfo.userId?e():s.getUserInfo(e)}))):t&&t(404)},t.exports=s,cc._RF.pop()},{tool:"tool"}],item:[function(e,t,i){"use strict";cc._RF.push(t,"5e2cfE94UdHqIxybFaSnqEP","item");var h=e("tool"),a=["废铁","青铜","白银","黄金","铂金","钻石","大师","最强王者"],u=1000,d=40,f=[cc.color("#726D63"),cc.color("#28C28D"),cc.color("#FB7D0F"),cc.color("#0FE2FB"),cc.color("#5AEEFF"),cc.color("#FB0FCF"),cc.color("#FF0000")];cc.Class({extends:e("viewCell"),properties:{idxFrame:[cc.SpriteFrame],idx:cc.Sprite,leap:cc.Label,rank:cc.Label,head:cc.Sprite,nickName:cc.Label,score:cc.Label},setSelf:function(e,t){this.init(e,t)},init:function(e,t){var i,n,o,r=t[e],s=r.avatarUrl,l=r.nickname,c=r.score;this.idx.spriteFrame=this.idxFrame[e]||null,this.rank.string=3<=e?e+1:"",this.nickName.string=l,this.score.string=c,this.leap.string=function(e){for(var t=a,i=u,n=d,o=parseInt(e/i),r=t[o=o>=t.length?t.length-1:o],s=parseInt((e-o*i)/n)+1,l=0;l<s;l++)r+="★";return r}(c),this.leap.node.color=(i=c,n=u,6<(o=Math.floor(i/n))&&(o=6),f[o]),h.changeSpritFrame(this.head,s)}}),cc._RF.pop()},{tool:"tool",viewCell:"viewCell"}],math:[function(e,t,i){"use strict";cc._RF.push(t,"a320egbwN1KmL06jQzyB3/u","math");t.exports={},cc._RF.pop()},{}],oba:[function(e,t,i){"use strict";cc._RF.push(t,"8f889B7JitEqIb0Ro5bz7Hy","oba");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function h(e,t,i){var n=function(e,t,i){e.$observer||(e.$observer=this);var n=e.$observer,o=[];for(var r in h.isArray(e)&&(0===e.length&&(e.$observeProps={},e.$observeProps.$observerPath="#"),n.mock(e)),e)e.hasOwnProperty(r)&&(i?h.isArray(t)&&h.isInArray(t,r)?(o.push(r),n.watch(e,r)):h.isString(t)&&r==t&&(o.push(r),n.watch(e,r)):(o.push(r),n.watch(e,r)));n.target=e,n.propertyChangedHandler||(n.propertyChangedHandler=[]);var s=i||t;n.propertyChangedHandler.push({all:!i,propChanged:s,eventPropArr:o})};return n.prototype={onPropertyChanged:function(e,t,i,n,o){if(t!==i&&this.propertyChangedHandler)for(var r=h._getRootName(e,o),s=0,l=this.propertyChangedHandler.length;s<l;s++){var c=this.propertyChangedHandler[s];(c.all||h.isInArray(c.eventPropArr,r)||0===r.indexOf("Array-"))&&c.propChanged.call(this.target,e,t,i,o)}0!==e.indexOf("Array-")&&"object"===(void 0===t?"undefined":a(t))&&this.watch(n,e,n.$observeProps.$observerPath)},mock:function(e,o){var r=this;h.methods.forEach(function(n){e[n]=function(){var e=Array.prototype.slice.call(this,0),t=Array.prototype[n].apply(this,Array.prototype.slice.call(arguments));if(new RegExp("\\b"+n+"\\b").test(h.triggerStr)){for(var i in this)this.hasOwnProperty(i)&&!h.isFunction(this[i])&&r.watch(this,i,this.$observeProps.$observerPath);r.onPropertyChanged("Array-"+n+(o?"-"+o:""),this,e,this,this.$observeProps.$observerPath)}return t},e["real"+n.substring(0,1).toUpperCase()+n.substring(1)]=function(){return Array.prototype[n].apply(this,Array.prototype.slice.call(arguments))}})},watch:function(i,n,e){if("$observeProps"!==n&&"$observer"!==n&&!h.isFunction(i[n])){i.$observeProps||(i.$observeProps={}),i.$observeProps.$observerPath=void 0!==e?e:"#";var o=this,t=i.$observeProps[n]=i[n];if(Object.defineProperty(i,n,{get:function(){return this.$observeProps[n]},set:function(e){var t=this.$observeProps[n];this.$observeProps[n]=e,o.onPropertyChanged(n,e,t,this,i.$observeProps.$observerPath)}}),"object"==(void 0===t?"undefined":a(t)))for(var r in h.isArray(t)&&(this.mock(t,n),0===t.length&&(t.$observeProps||(t.$observeProps={}),t.$observeProps.$observerPath=void 0!==e?e:"#")),t)t.hasOwnProperty(r)&&this.watch(t,r,i.$observeProps.$observerPath+"-"+n)}}},new n(e,t,i)};n.methods=["concat","copyWithin","entries","every","fill","filter","find","findIndex","forEach","includes","indexOf","join","keys","lastIndexOf","map","pop","push","reduce","reduceRight","reverse","shift","slice","some","sort","splice","toLocaleString","toString","unshift","values","size"],n.triggerStr=["concat","copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift","size"].join(","),n.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isString=function(e){return"string"==typeof e},n.isInArray=function(e,t){for(var i=e.length;-1<--i;)if(t===e[i])return!0;return!1},n.isFunction=function(e){return"[object Function]"==Object.prototype.toString.call(e)},n._getRootName=function(e,t){return"#"===t?e:t.split("-")[1]},n.add=function(e,t){e.$observer.watch(e,t)},n.set=function(e,t,i,n){n||(e[t]=i),e.$observer.watch(e,t),n&&(e[t]=i)},Array.prototype.size=function(e){this.length=e},t.exports=n,cc._RF.pop()},{}],qtree:[function(e,t,i){"use strict";cc._RF.push(t,"41ddfkpDx5ERbFbz8dRySTa","qtree");var n,o,v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e("math");n=void 0,o=function(){return function(){var _,p,S,n,x,s,o,I;function g(e){var t,i;if(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.maxElements=e.maxElements,null==this.width||null==this.height)throw new Error("Missing quadtree dimensions.");if(null==this.x&&(this.x=0),null==this.y&&(this.y=0),null==this.maxElements&&(this.maxElements=1),this.contents=[],this.oversized=[],this.size=0,this.width<1||this.height<1)throw new Error("Dimensions must be positive integers.");if(!Number.isInteger(this.x)||!Number.isInteger(this.y))throw new Error("Coordinates must be integers");if(this.maxElements<1)throw new Error("The maximum number of elements before a split must be a positive integer.");for(t in(i=this).children={NW:{create:function(){return new g({x:i.x,y:i.y,width:Math.max(Math.floor(i.width/2),1),height:Math.max(Math.floor(i.height/2),1),maxElements:i.maxElements})},tree:null},NE:{create:function(){return new g({x:r.add(i.x,Math.max(Math.floor(i.width/2),1)),y:i.y,width:Math.ceil(i.width/2),height:Math.max(Math.floor(i.height/2),1),maxElements:i.maxElements})},tree:null},SW:{create:function(){return new g({x:i.x,y:r.add(i.y,Math.max(Math.floor(i.height/2),1)),width:Math.max(Math.floor(i.width/2),1),height:Math.ceil(i.height/2),maxElements:i.maxElements})},tree:null},SE:{create:function(){return new g({x:r.add(i.x,Math.max(Math.floor(i.width/2),1)),y:r.add(i.y,Math.max(Math.floor(i.height/2),1)),width:Math.ceil(i.width/2),height:Math.ceil(i.height/2),maxElements:i.maxElements})},tree:null}},this.children)this.children[t].get=function(){return null!=this.tree||(this.tree=this.create()),this.tree}}return n=function(e){var t,i;return{x:r.add(Math.floor((null!=(t=e.width)?t:1)/2),e.x),y:r.add(Math.floor((null!=(i=e.height)?i:1)/2),e.y)}},_=function(e,t){return cc.Intersection.rectRect(e,t)},p=function(e,t){var i;return i=n(t),e.x<i.x?e.y<i.y?"NW":"SW":e.y<i.y?"NE":"SE"},I=function(e){if("object"!==(void 0===e?"undefined":v(e)))throw new Error("Element must be an Object.");if(null==e.x||null==e.y)throw new Error("Coordinates properties are missing.");if((null!=e?e.width:void 0)<0||(null!=e?e.height:void 0)<0)throw new Error("Width and height must be positive integers.")},s=function(e){var t,i,n,o;return i=Math.max(Math.floor(e.width/2),1),n=Math.ceil(e.width/2),o=Math.max(Math.floor(e.height/2),1),t=Math.ceil(e.height/2),{NW:{x:e.x,y:e.y,width:i,height:o},NE:{x:r.add(e.x,i),y:e.y,width:n,height:o},SW:{x:e.x,y:r.add(e.y,o),width:i,height:t},SE:{x:r.add(e.x,i),y:r.add(e.y,o),width:n,height:t}}},S=function(e,t){var i,n,o,r;for(n in r=[],o=s(t))i=o[n],_(e,i)&&r.push(n);return r},x=function(e,i){var t;return(t=function(t){return e["_"+t]=e[t],Object.defineProperty(e,t,{set:function(e){return i.remove(this,!0),this["_"+t]=e,i.push(this)},get:function(){return this["_"+t]},configurable:!0})})("x"),t("y"),t("width"),t("height")},o=function(t){var e;return(e=function(e){if(null!=t["_"+e])return delete t[e],t[e]=t["_"+e],delete t["_"+e]})("x"),e("y"),e("width"),e("height")},g.prototype.clear=function(){var e,t;for(e in this.contents=[],this.oversized=[],this.size=0,t=[],this.children)t.push(this.children[e].tree=null);return t},g.prototype.push=function(e,t){return this.pushAll([e],t)},g.prototype.pushAll=function(e,t){var i,n,o,r,s,l,c,h,a,u,d,f,p,g,_,v,y,m,C,w;for(d=0,g=e.length;d<g;d++)u=e[d],I(u),t&&x(u,this);for(c=[{tree:this,elements:e}];0<c.length;){for(w=(y=c.shift()).tree,h={NW:null,NE:null,SW:null,SE:null},f=0,_=(l=y.elements).length;f<_;f++)if(s=l[f],w.size++,1!==(a=S(s,w)).length||1===w.width||1===w.height)w.oversized.push(s);else if(w.size-w.oversized.length<=w.maxElements)w.contents.push(s);else{for(r=a[0],C=w.children[r],null==h[r]&&(h[r]={tree:C.get(),elements:[]}),h[r].elements.push(s),p=0,v=(m=w.contents).length;p<v;p++)n=m[p],null==h[o=S(n,w)[0]]&&(h[o]={tree:w.children[o].get(),elements:[]}),h[o].elements.push(n);w.contents=[]}for(r in h)null!=(i=h[r])&&c.push(i)}return this},g.prototype.remove=function(e,t){var i,n;return I(e),-1<(i=this.oversized.indexOf(e))?(this.oversized.splice(i,1),this.size--,t||o(e),!0):-1<(i=this.contents.indexOf(e))?(this.contents.splice(i,1),this.size--,t||o(e),!0):!(null==(n=this.children[p(e,this)]).tree||!n.tree.remove(e,t))&&(this.size--,0===n.tree.size&&(n.tree=null),!0)},g.prototype.colliding=function(e,t){var i,n,o,r,s,l,c,h,a,u,d,f,p,g;for(null==t&&(t=_),I(e),s=[],o=[this];0<o.length;){for(l=0,a=(f=(g=o.shift()).oversized).length;l<a;l++)(n=f[l])!==e&&t(e,n)&&s.push(n);for(c=0,u=(p=g.contents).length;c<u;c++)(n=p[c])!==e&&t(e,n)&&s.push(n);for(0===(r=S(e,g)).length&&(r=[],e.x>=g.x+g.width&&r.push("NE"),e.y>=g.y+g.height&&r.push("SW"),0<r.length&&(1===r.length?r.push("SE"):r=["SE"])),h=0,d=r.length;h<d;h++)i=r[h],null!=g.children[i].tree&&o.push(g.children[i].tree)}return s},g.prototype.onCollision=function(e,t,i){var n,o,r,s,l,c,h,a,u,d,f,p,g;for(null==i&&(i=_),I(e),r=[this];0<r.length;){for(l=0,a=(f=(g=r.shift()).oversized).length;l<a;l++)if((o=f[l])!==e&&i(e,o)&&!1===t(o))return;for(c=0,u=(p=g.contents).length;c<u;c++)if((o=p[c])!==e&&i(e,o)&&!1===t(o))return;for(0===(s=S(e,g)).length&&(s=[],e.x>=g.x+g.width&&s.push("NE"),e.y>=g.y+g.height&&s.push("SW"),0<s.length&&(1===s.length?s.push("SE"):s=["SE"])),h=0,d=s.length;h<d;h++)n=s[h],null!=g.children[n].tree&&r.push(g.children[n].tree)}return null},g.prototype.get=function(e){return this.where(e)},g.prototype.where=function(n){var e,t,i,o,r,s,l,c,h,a,u,d,f;if("object"===(void 0===n?"undefined":v(n))&&(null==n.x||null==n.y))return this.find(function(e){var t,i;for(i in t=!0,n)n[i]!==e[i]&&(t=!1);return t});for(I(n),o=[],i=[this];0<i.length;){for(r=0,c=(a=(f=i.shift()).oversized).length;r<c;r++){for(l in t=a[r],e=!0,n)n[l]!==t[l]&&(e=!1);e&&o.push(t)}for(s=0,h=(u=f.contents).length;s<h;s++){for(l in t=u[s],e=!0,n)n[l]!==t[l]&&(e=!1);e&&o.push(t)}null!=(d=f.children[p(n,f)]).tree&&i.push(d.tree)}return o},g.prototype.each=function(e){var t,i,n,o,r,s,l,c,h,a;for(i=[this];0<i.length;){for(o=0,s=(c=(a=i.shift()).oversized).length;o<s;o++)n=c[o],"function"==typeof e&&e(n);for(r=0,l=(h=a.contents).length;r<l;r++)n=h[r],"function"==typeof e&&e(n);for(t in a.children)null!=a.children[t].tree&&i.push(a.children[t].tree)}return this},g.prototype.find=function(e){var t,i,n,o,r,s,l,c,h,a,u;for(i=[this],o=[];0<i.length;){for(r=0,l=(h=(u=i.shift()).oversized).length;r<l;r++)n=h[r],("function"==typeof e?e(n):void 0)&&o.push(n);for(s=0,c=(a=u.contents).length;s<c;s++)n=a[s],("function"==typeof e?e(n):void 0)&&o.push(n);for(t in u.children)null!=u.children[t].tree&&i.push(u.children[t].tree)}return o},g.prototype.filter=function(d){var f;return(f=function(e){var t,i,n,o,r,s,l,c,h,a,u;for(t in(i=new g({x:e.x,y:e.y,width:e.width,height:e.height,maxElements:e.maxElements})).size=0,e.children)null!=e.children[t].tree&&(i.children[t].tree=f(e.children[t].tree),i.size+=null!=(c=null!=(h=i.children[t].tree)?h.size:void 0)?c:0);for(o=0,s=(a=e.oversized).length;o<s;o++)n=a[o],(null==d||("function"==typeof d?d(n):void 0))&&i.oversized.push(n);for(r=0,l=(u=e.contents).length;r<l;r++)n=u[r],(null==d||("function"==typeof d?d(n):void 0))&&i.contents.push(n);return i.size+=i.oversized.length+i.contents.length,0===i.size?null:i})(this)},g.prototype.reject=function(t){return this.filter(function(e){return!("function"==typeof t?t(e):void 0)})},g.prototype.visit=function(e){var t,i,n;for(i=[this];0<i.length;)for(t in n=i.shift(),e.bind(n)(),n.children)null!=n.children[t].tree&&i.push(n.children[t].tree);return this},g.prototype.pretty=function(){var e,t,i,n,o,r,s;for(r="",i=function(e){var t,i,n;for(n="",t=i=e;i<=0?t<0:0<t;i<=0?++t:--t)n+="   ";return n},t=[{label:"ROOT",tree:this,level:0}];0<t.length;){for(e in r+=(n=i((s=t.shift()).level))+"| "+s.label+"\n"+n+"| ------------\n",0<s.tree.oversized.length&&(r+=n+"| * Oversized elements *\n"+n+"|   "+s.tree.oversized+"\n"),0<s.tree.contents.length&&(r+=n+"| * Leaf content *\n"+n+"|   "+s.tree.contents+"\n"),o=!1,s.tree.children)null!=s.tree.children[e].tree&&(o=!0,t.unshift({label:e,tree:s.tree.children[e].tree,level:s.level+1}));o&&(r+=n+"└──┐\n")}return r},g}()},"function"==typeof define&&define.amd?define([],o):"object"===(void 0===i?"undefined":v(i))&&t.exports?t.exports=o():n.Quadtree=o(),cc._RF.pop()},{math:"math"}],rank:[function(e,t,i){"use strict";cc._RF.push(t,"280c3rsZJJKnZ9RqbALVwtK","rank");var n=e("cmd");cc.Class({extends:cc.Component,properties:{item:cc.Prefab,tableView:cc.Node,selfInfo:cc.Node,rank:cc.Label,bestScore:cc.Label,say:cc.Label},ctor:function(){this._rankIndex=-1,this._score=-1},onLoad:function(){cc.systemEvent.on("wxEvent",function(e){var t=e.detail;"setUserScore"===t.event?this._score=t.data||0:"rank"===t.event?(this.node.active=!0,this.updateRank(t.data)):"groupRank"===t.event?(this.node.active=!0,this.updateGroupRank(t.data)):"surpass"===t.event&&(this.node.active=!1)},this),this.node.active=!1},updateGroupRank:function(e){var r=this;e&&(this.rank.string="",this.bestScore.string="",this.selfInfo.active=!1,n.getGroupWeekScore(e,function(e,t,i){if(!e){var n=t[i];if(t.sort(function(e,t){return t.score-e.score||e.openid-t.openid}),r.tableView.getComponent(cc.tableView).initTableView(t.length,t),0<=i){var o=t.indexOf(n);if(0<=o)return void r.setSelf(o,t,3)}}}))},updateRank:function(r){var s=this;this.rank.string="",this.bestScore.string="",this.selfInfo.active=!1,n.getFriendWeekScore(function(e,t,i){if(!e){var n=t[i];if(t.sort(function(e,t){return t.score-e.score||e.openid-t.openid}),s.tableView.getComponent(cc.tableView).initTableView(t.length,t),0<=i){var o=t.indexOf(n);if(0<=o)return void s.setSelf(o,t,r)}}})},setSelf:function(e,t,i){-1===this._rankIndex&&(this._rankIndex=e),1==i?(this.rank.string="",this.bestScore.string="",this.selfInfo.active=!0,this.selfInfo.getComponent("item").setSelf(e,t)):2==i?(this.rank.string=e+1,this.bestScore.string=t[e].score,this.selfInfo.active=!1):(this.say.string="",this.rank.string="",this.bestScore.string="",this.selfInfo.active=!0,this.selfInfo.getComponent("item").setSelf(e,t))},clear:function(){this.tableView.getComponent(cc.tableView).clear()}}),cc._RF.pop()},{cmd:"cmd"}],surpass:[function(e,t,i){"use strict";cc._RF.push(t,"f00c3YmBkNBeZhnPV9qvyRj","surpass");var n=e("cmd"),l=e("tool");cc.Class({extends:cc.Component,properties:{left:cc.Sprite,self:cc.Sprite,right:cc.Sprite,leftScore:cc.Label,selfScore:cc.Label,rightScore:cc.Label},onLoad:function(){cc.systemEvent.on("wxEvent",function(e){var t=e.detail;"score"===t.event?this.updateSurpass(t.data):"surpass"===t.event?this.node.active=!0:"rank"===t.event?this.node.active=!1:"groupRank"===t.event&&(this.node.active=!1)},this),this.node.active=!1},updateSurpass:function(r){var s=this;this.selfScore.string=r,n.getFriendWeekScore(function(e,t,i){if(!e){var n=t[i];n.score=r,t.sort(function(e,t){return t.score-e.score||e.openid-t.openid});var o=t.indexOf(n);0<o?(s.left.node.parent.parent.active=!0,l.changeSpritFrame(s.left,t[o-1].avatarUrl),s.leftScore.string=t[o-1].score):(s.left.node.parent.parent.active=!1,l.changeSpritFrame(s.left,null),s.leftScore.string="0"),l.changeSpritFrame(s.self,n.avatarUrl),o<t.length-1?(s.right.node.parent.parent.active=!0,l.changeSpritFrame(s.right,t[o+1].avatarUrl),s.rightScore.string=t[o+1].score):(s.right.node.parent.parent.active=!1,l.changeSpritFrame(s.right,null),s.rightScore.string="0")}})}}),cc._RF.pop()},{cmd:"cmd",tool:"tool"}],tableView:[function(e,t,i){"use strict";cc._RF.push(t,"894d3NPS+5BQovVj+CVciYS","tableView");var s=cc.Enum({Horizontal:0,Vertical:1}),r=cc.Enum({None:0,Up:1,Down:2,Left:3,Rigth:4}),l=cc.Enum({LEFT_TO_RIGHT__TOP_TO_BOTTOM:0,TOP_TO_BOTTOM__LEFT_TO_RIGHT:1}),c=cc.Enum({Scroll:0,Flip:1});var n=cc.Class({extends:cc.ScrollView,editor:!1,properties:{_data:null,_minCellIndex:0,_maxCellIndex:0,_paramCount:0,_count:0,_cellCount:0,_showCellCount:0,_groupCellCount:null,_scrollDirection:r.None,_cellPool:null,_view:null,_page:0,_pageTotal:0,_touchLayer:cc.Node,cell:{default:null,type:cc.Prefab,notify:function(e){}},ScrollModel:{default:0,type:s,notify:function(e){this.ScrollModel===s.Horizontal?(this.horizontal=!0,this.vertical=!1,this.verticalScrollBar=null):(this.vertical=!0,this.horizontal=!1,this.horizontalScrollBar=null)},tooltip:"横向纵向滑动"},ViewType:{default:0,type:c,notify:function(e){this.ViewType===c.Flip?this.inertia=!1:this.inertia=!0},tooltip:"为Scroll时,不做解释\n为Flipw时，在Scroll的基础上增加翻页的行为"},isFill:{default:!1,tooltip:"当节点不能铺满一页时，选择isFill为true会填充节点铺满整个view"},Direction:{default:0,type:l,tooltip:"规定cell的排列方向"},pageChangeEvents:{default:[],type:cc.Component.EventHandler,tooltip:"仅当ViewType为pageView时有效，初始化或翻页时触发回调，向回调传入两个参数，参数一为当前处于哪一页，参数二为一共多少页"}},statics:{_cellPoolCache:{}},onLoad:function(){var e=window.s=this;n._tableView.push(this);var t=this.node.destroy;this.node.destroy=function(){e.clear(),t.call(e.node)};var i=this.node._onPreDestroy;this.node._onPreDestroy=function(){e.clear(),i.call(e.node)}},onDestroy:function(){for(var e in n._tableView)if(n._tableView[e]===this)return void n._tableView.splice(e)},_initCell:function(e,t){if(this.ScrollModel===s.Horizontal&&this.Direction===l.TOP_TO_BOTTOM__LEFT_TO_RIGHT||this.ScrollModel===s.Vertical&&this.Direction===l.LEFT_TO_RIGHT__TOP_TO_BOTTOM)for(var i=e.tag*e.childrenCount,n=0;n<e.childrenCount;++n){(r=e.children[n].getComponent("viewCell"))&&(r._cellInit_(this),r.init(i+n,this._data,t,[e.tag,n]))}else if(this.ViewType===c.Flip){var o=(i=Math.floor(e.tag/this._showCellCount))*this._showCellCount*e.childrenCount;for(n=0;n<e.childrenCount;++n){(r=e.children[n].getComponent("viewCell"))&&(r._cellInit_(this),r.init(this._showCellCount*n+e.tag%this._showCellCount+o,this._data,t,[n+i*e.childrenCount,n]))}}else for(n=0;n<e.childrenCount;++n){var r;(r=e.children[n].getComponent("viewCell"))&&(r._cellInit_(this),r.init(n*this._count+e.tag,this._data,t,[n,n]))}},_setCellPosition:function(e,t){this.ScrollModel===s.Horizontal?(e.x=0===t?-this.content.width*this.content.anchorX+e.width*e.anchorX:this.content.getChildByTag(t-1).x+e.width,e.y=(e.anchorY-this.content.anchorY)*e.height):(e.y=0===t?this.content.height*(1-this.content.anchorY)-e.height*(1-e.anchorY):this.content.getChildByTag(t-1).y-e.height,e.x=(e.anchorX-this.content.anchorX)*e.width)},_addCell:function(e){var t=this._getCell();this._setCellAttr(t,e),this._setCellPosition(t,e),t.parent=this.content,this._initCell(t)},_setCellAttr:function(e,t){e.setSiblingIndex(t>=e.tag?this._cellCount:0),e.tag=t},_addCellsToView:function(){for(var e=0;e<=this._maxCellIndex;++e)this._addCell(e)},_getCell:function(){if(0===this._cellPool.size()){var e=cc.instantiate(this.cell),t=new cc.Node;t.anchorX=.5,t.anchorY=.5;var i=0;if(this.ScrollModel===s.Horizontal){t.width=e.width;var n=Math.floor(this.content.height/e.height);t.height=this.content.height;for(var o=0;o<n;++o)e||(e=cc.instantiate(this.cell)),e.x=(e.anchorX-.5)*e.width,e.y=t.height/2-e.height*(1-e.anchorY)-i,i+=e.height,e.parent=t,e=null}else{t.height=e.height;n=Math.floor(this.content.width/e.width);t.width=this.content.width;for(o=0;o<n;++o)e||(e=cc.instantiate(this.cell)),e.y=(e.anchorY-.5)*e.height,e.x=-t.width/2+e.width*e.anchorX+i,i+=e.width,e.parent=t,e=null}this._cellPool.put(t)}return e=this._cellPool.get()},_getCellSize:function(){var e=this._getCell(),t=e.getContentSize();return this._cellPool.put(e),t},_getGroupCellCount:function(){var e=this._getCell(),t=e.childrenCount;return this._cellPool.put(e),t},clear:function(){for(var e=this.content.childrenCount-1;0<=e;--e)this._cellPool.put(this.content.children[e]);this._cellCount=0,this._showCellCount=0},reload:function(e){void 0!==e&&(this._data=e);for(var t=this.content.childrenCount-1;0<=t;--t)this._initCell(this.content.children[t],!0)},_getCellPoolCacheName:function(){return this.ScrollModel===s.Horizontal?this.cell.name+"h"+this.content.height:this.cell.name+"w"+this.content.width},_initTableView:function(){this._cellPool&&this.clear();var e=this._getCellPoolCacheName();n._cellPoolCache[e]||(n._cellPoolCache[e]=new cc.NodePool("viewCell")),this._cellPool=n._cellPoolCache[e],this._cellSize=this._getCellSize(),this._groupCellCount=this._getGroupCellCount(),this._count=Math.ceil(this._paramCount/this._groupCellCount),this.ScrollModel===s.Horizontal?(this._view.width=this.node.width,this._view.x=(this._view.anchorX-this.node.anchorX)*this._view.width,this._cellCount=Math.ceil(this._view.width/this._cellSize.width)+1,this.ViewType===c.Flip?this._cellCount>this._count?(this.isFill?this._cellCount=Math.floor(this._view.width/this._cellSize.width):this._cellCount=this._count,this._showCellCount=this._cellCount,this._pageTotal=1):(this._pageTotal=Math.ceil(this._count/(this._cellCount-1)),this._count=this._pageTotal*(this._cellCount-1),this._showCellCount=this._cellCount-1):this._cellCount>this._count?(this.isFill?this._cellCount=Math.floor(this._view.width/this._cellSize.width):this._cellCount=this._count,this._showCellCount=this._cellCount):this._showCellCount=this._cellCount-1,this.content.width=this._count*this._cellSize.width,this.stopAutoScroll(),this.scrollToLeft()):(this._view.height=this.node.height,this._view.y=(this._view.anchorY-this.node.anchorY)*this._view.height,this._cellCount=Math.ceil(this._view.height/this._cellSize.height)+1,this.ViewType===c.Flip?this._cellCount>this._count?(this.isFill?this._cellCount=Math.floor(this._view.height/this._cellSize.height):this._cellCount=this._count,this._showCellCount=this._cellCount,this._pageTotal=1):(this._pageTotal=Math.ceil(this._count/(this._cellCount-1)),this._count=this._pageTotal*(this._cellCount-1),this._showCellCount=this._cellCount-1):this._cellCount>this._count?(this.isFill?this._cellCount=Math.floor(this._view.height/this._cellSize.height):this._cellCount=this._count,this._showCellCount=this._cellCount):this._showCellCount=this._cellCount-1,this.content.height=this._count*this._cellSize.height,this.stopAutoScroll(),this.scrollToTop()),this._changePageNum(1-this._page),this._lastOffset=this.getScrollOffset(),this._minCellIndex=0,this._maxCellIndex=this._cellCount-1,this._addCellsToView()},initTableView:function(e,t){this._paramCount=e,this._data=t,this.ScrollModel===s.Horizontal?(this.horizontal=!0,this.vertical=!1):(this.vertical=!0,this.horizontal=!1),this._view=this.content.parent,this.verticalScrollBar&&this.verticalScrollBar.node.on("size-changed",function(){this._updateScrollBar(this._getHowMuchOutOfBoundary())},this),this.horizontalScrollBar&&this.horizontalScrollBar.node.on("size-changed",function(){this._updateScrollBar(this._getHowMuchOutOfBoundary())},this),this.node.getComponent(cc.Widget)&&this.node.getComponent(cc.Widget).updateAlignment(),this._initTableView()},_onTouchBegan:function(e,t){this._super(e,t),this._touchstart(e)},_onTouchMoved:function(e,t){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(e,t)){var i=e.touch;if(this.content&&this._handleMoveLogic(i),this.cancelInnerEvents){var n=cc.pSub(i.getLocation(),i.getStartLocation());if(7<cc.pLength(n)&&!this._touchMoved&&e.target!==this.node){var o=new cc.Event.EventTouch(e.getTouches(),e.bubbles);o.type=cc.Node.EventType.TOUCH_CANCEL,o.touch=e.touch,o.simulate=!0,e.target.emit(cc.Node.EventType.TOUCH_CANCEL,o),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(e),this._touchmove(e)}}},_onTouchEnded:function(e,t){this._super(e,t),this._touchend(e)},_onTouchCancelled:function(e,t){this._super(e,t),this._touchend(e)},stopAutoScroll:function(){this._scrollDirection=r.None,this._super()},scrollToBottom:function(e,t){this._scrollDirection=r.Up,this._super(e,t)},scrollToTop:function(e,t){this._scrollDirection=r.Down,this._super(e,t)},scrollToLeft:function(e,t){this._scrollDirection=r.Rigth,this._super(e,t)},scrollToRight:function(e,t){this._scrollDirection=r.Left,this._super(e,t)},scrollToOffset:function(e,t,i){var n=this.getScrollOffset(),o=cc.pSub(e,n);this.ScrollModel===s.Horizontal?0<o.x?this._scrollDirection=r.Left:o.x<0&&(this._scrollDirection=r.Rigth):0<o.y?this._scrollDirection=r.Up:o.y<0&&(this._scrollDirection=r.Down),this._super(e,t,i)},addScrollEvent:function(e,t,i){var n=new cc.Component.EventHandler;n.target=e,n.component=t,n.handler=i,this.scrollEvents.push(n)},removeScrollEvent:function(e){for(var t in this.scrollEvents){if(this.scrollEvents[t].target===e)return void this.scrollEvents.splice(t,1)}},clearScrollEvent:function(){this.scrollEvents=[]},addPageEvent:function(e,t,i){var n=new cc.Component.EventHandler;n.target=e,n.component=t,n.handler=i,this.pageChangeEvents.push(n)},removePageEvent:function(e){for(var t=0;t<this.pageChangeEvents.length;t++){if(this.pageChangeEvents[t].target===e)return void this.pageChangeEvents.splice(t,1)}},clearPageEvent:function(){this.pageChangeEvents=[]},scrollToNextPage:function(){this.scrollToPage(this._page+1)},scrollToLastPage:function(){this.scrollToPage(this._page-1)},scrollToPage:function(e){if(this.ViewType===c.Flip&&e!==this._page&&!(e<1||e>this._pageTotal)){var t=.3*Math.abs(e-this._page);this._changePageNum(e-this._page);var i=this._view.width,n=this._view.height;i=(this._page-1)*i,n=(this._page-1)*n,this.scrollToOffset({x:i,y:n},t)}},getCells:function(e){var t=[],i=function e(t,i){if(t.length<=1)return t;for(var n=Math.floor(t.length/2),o=t[n],r=[],s=[],l=0;l<t.length;l++)l!==n&&(i?i(t[l],o)?r.push(t[l]):s.push(t[l]):t[l]<=o?r.push(t[l]):s.push(t[l]));return e(r,i).concat([o],e(s,i))}(this.content.children,function(e,t){return e.tag<t.tag});for(var n in i){var o=i[n];for(var r in o.children)t.push(o.children[r])}e(t)},getData:function(){return this._data},getGroupsRange:function(e){for(var t=[],i=this._minCellIndex;i<=this._maxCellIndex;i++)t.push(i);e(t)},_changePageNum:function(e){this._page+=e,this._page<=0?this._page=1:this._page>this._pageTotal&&(this._page=this._pageTotal);for(var t=0;t<this.pageChangeEvents.length;t++){this.pageChangeEvents[t].emit([this._page,this._pageTotal])}},_touchstart:function(e){this.ScrollModel===s.Horizontal?this.horizontal=!1:this.vertical=!1},_touchmove:function(e){if(this.horizontal===this.vertical){var t=e.getStartLocation(),i=e.getLocation();if(this.ScrollModel===s.Horizontal){if(Math.abs(i.x-t.x)<=7)return}else if(Math.abs(i.y-t.y)<=7)return;this.ScrollModel===s.Horizontal?this.horizontal=!0:this.vertical=!0}},_touchend:function(e){this.ScrollModel===s.Horizontal?this.horizontal=!0:this.vertical=!0,this.ViewType===c.Flip&&1<this._pageTotal&&this._pageMove(e)},_pageMove:function(e){var t=this._view.width,i=this._view.height;if(this.ViewType===c.Flip){var n=this.getScrollOffset(),o=this.getMaxScrollOffset();if(this.ScrollModel===s.Horizontal){if(0<=n.x||n.x<=-o.x)return;if(i=0,Math.abs(e.getLocation().x-e.getStartLocation().x)>this._view.width/4)if(this._scrollDirection===r.Left){if(!(this._page<this._pageTotal))return;this._changePageNum(1)}else if(this._scrollDirection===r.Rigth){if(!(1<this._page))return;this._changePageNum(-1)}}else{if(n.y>=o.y||n.y<=0)return;if(t=0,Math.abs(e.getLocation().y-e.getStartLocation().y)>this._view.height/4)if(this._scrollDirection===r.Up){if(!(this._page<this._pageTotal))return;this._changePageNum(1)}else if(this._scrollDirection===r.Down){if(!(1<this._page))return;this._changePageNum(-1)}}t=(this._page-1)*t,i=(this._page-1)*i,this.scrollToOffset({x:t,y:i},.3)}},_getBoundingBoxToWorld:function(e){var t=e.convertToWorldSpace(cc.p(0,0));return cc.rect(t.x,t.y,e.width,e.height)},_updateCells:function(){if(this.ScrollModel===s.Horizontal){if(this._scrollDirection===r.Left){if(this._maxCellIndex<this._count-1){var e=this._getBoundingBoxToWorld(this._view);do{var t=this.content.getChildByTag(this._minCellIndex);if(!((i=this._getBoundingBoxToWorld(t)).xMax<=e.xMin))break;t.x=this.content.getChildByTag(this._maxCellIndex).x+t.width,this._minCellIndex++,this._maxCellIndex++,i.xMax+(this._maxCellIndex-this._minCellIndex+1)*t.width>e.xMin&&(this._setCellAttr(t,this._maxCellIndex),this._initCell(t))}while(this._maxCellIndex!==this._count-1)}}else if(this._scrollDirection===r.Rigth&&0<this._minCellIndex){e=this._getBoundingBoxToWorld(this._view);do{t=this.content.getChildByTag(this._maxCellIndex);if(!((i=this._getBoundingBoxToWorld(t)).xMin>=e.xMax))break;t.x=this.content.getChildByTag(this._minCellIndex).x-t.width,this._minCellIndex--,this._maxCellIndex--,i.xMin-(this._maxCellIndex-this._minCellIndex+1)*t.width<e.xMax&&(this._setCellAttr(t,this._minCellIndex),this._initCell(t))}while(0!==this._minCellIndex)}}else if(this._scrollDirection===r.Up){if(this._maxCellIndex<this._count-1){e=this._getBoundingBoxToWorld(this._view);do{t=this.content.getChildByTag(this._minCellIndex);if(!((i=this._getBoundingBoxToWorld(t)).yMin>=e.yMax))break;t.y=this.content.getChildByTag(this._maxCellIndex).y-t.height,this._minCellIndex++,this._maxCellIndex++,i.yMin-(this._maxCellIndex-this._minCellIndex+1)*t.height<e.yMax&&(this._setCellAttr(t,this._maxCellIndex),this._initCell(t))}while(this._maxCellIndex!==this._count-1)}}else if(this._scrollDirection===r.Down&&0<this._minCellIndex){e=this._getBoundingBoxToWorld(this._view);do{var i;t=this.content.getChildByTag(this._maxCellIndex);if(!((i=this._getBoundingBoxToWorld(t)).yMax<=e.yMin))break;t.y=this.content.getChildByTag(this._minCellIndex).y+t.height,this._minCellIndex--,this._maxCellIndex--,i.yMax+(this._maxCellIndex-this._minCellIndex+1)*t.width>e.yMin&&(this._setCellAttr(t,this._minCellIndex),this._initCell(t))}while(0!==this._minCellIndex)}},_getScrollDirection:function(){var e=this.getScrollOffset(),t=this._lastOffset;this._lastOffset=e,e=cc.pSub(e,t),this.ScrollModel===s.Horizontal?0<e.x?this._scrollDirection=r.Rigth:e.x<0?this._scrollDirection=r.Left:this._scrollDirection=r.None:e.y<0?this._scrollDirection=r.Down:0<e.y?this._scrollDirection=r.Up:this._scrollDirection=r.None},update:function(e){this._super(e),this._cellCount!==this._showCellCount&&1!==this._pageTotal&&(this._getScrollDirection(),this._updateCells())}});n._tableView=[],n.reload=function(){for(var e in n._tableView)n._tableView[e].reload()},n.clear=function(){for(var e in n._tableView)n._tableView[e].clear()},cc.tableView=t.export=n,cc._RF.pop()},{}],tool:[function(e,t,i){"use strict";cc._RF.push(t,"819111CWnpB+6MMXVs6UPUy","tool");var n,o,r,s,l,c,h={};h.weekOfYear=function(e){var t=(e=e||new Date).getFullYear(),i=e.getMonth()+1,n=e.getDate(),o=new Date(t,parseInt(i)-1,n),r=new Date(t,0,1),s=Math.round((o.valueOf()-r.valueOf())/864e5);return Math.ceil((s+(r.getDay()+1-1))/7)},h.changeSpritFrame=function(e,t,i){var n=e.getComponent(cc.Sprite)||e;t?n.___kkpf===t&&n.spriteFrame?i&&i(null):(n.___kkpf=t,n.spriteFrame=null,cc.loader.load({url:t,type:"jpg"},function(e,t){e?i&&i(e,t):i?i(null,t):n.spriteFrame=new cc.SpriteFrame(t)})):(n.___kkpf="",n.spriteFrame=null)},n=/[^\x00-\xff]/g,h.sizeof=function(e){return e.replace(n,"ci").length},r=void(o=0),s="",c=l=0,h.cutString=function(e,t){for(s="",l=o=0,c=e.length;l<c&&(r=e.charCodeAt(l),!(t<(o+=r<=127?1:2)));l++)s+=e.substr(l,1);return s},h.trimString=function(e,t){return this.sizeof(e)>2*t?this.cutString(e,2*t-1)+"...":e},h.randomString=function(e,t){var i="",n="abcdefghijklmnopqrstuvwxyz1234567890";1==t?n="1234567890":2==t&&(n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890");for(var o=0;o<e;o++)i+=n.charAt(Math.floor(Math.random()*n.length));return i},t.exports=h,cc._RF.pop()},{}],url:[function(e,t,i){"use strict";cc._RF.push(t,"1e735bAMbpN7bAVmln5P8J5","url"),(t.exports={}).stringifyQueryString=function(e){var t="";for(var i in e)t+="&"+i+"="+e[i];return t.slice(1)},cc._RF.pop()},{}],viewCell:[function(e,t,i){"use strict";cc._RF.push(t,"0b3080L9CRFlbXAXSsMHFBZ","viewCell"),cc.Class({extends:cc.Component,properties:{tableView:{default:null,visible:!1},_isCellInit_:!1,_longClicked_:!1},_cellAddMethodToNode_:function(){this.node.clicked=this.clicked.bind(this)},_cellAddTouch_:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){!0===this.node.active&&0!==this.node.opacity&&(this._longClicked_||(this._longClicked_=!0,this.scheduleOnce(this._longClicked,1.5)))},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(){this._longClicked_&&(this._longClicked_=!1,this.unschedule(this._longClicked))},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.clicked(),this._longClicked_&&(this._longClicked_=!1,this.unschedule(this._longClicked))},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){this._longClicked_&&(this._longClicked_=!1,this.unschedule(this._longClicked))},this)},_cellInit_:function(e){this.tableView=e,this._isCellInit_||(this._cellAddMethodToNode_(),this._cellAddTouch_(),this._isCellInit_=!0)},_longClicked:function(){this._longClicked_=!1,this.node.emit(cc.Node.EventType.TOUCH_CANCEL),this.longClicked()},longClicked:function(){},clicked:function(){},init:function(e,t,i,n){}}),cc._RF.pop()},{}]},{},["app","cmd","item","base64","chalkProto","math","oba","qtree","url","rank","surpass","tableView","viewCell","tool"]);